'

class ToDoApp(QWidget):
    def __init__(self, username, switch_to_login_callback):
        super().__init__()
        loadUi("todo.ui", self)  # 載入 todo.ui
        self.username = username
        self.switch_to_login = switch_to_login_callback

        self.tasks_file = f"{self.username}_tasks.json"
        self.load_tasks()

        self.welcomeLabel.setText(f"歡迎，{self.username}！")

        # 新增分類選單和按鈕事件
        self.categoryComboBox.addItems(self.tasks.keys())
        self.addCategoryButton.clicked.connect(self.add_category)

        # 調整按鈕事件
        self.addButton.clicked.connect(self.add_task)
        self.deleteButton.clicked.connect(self.delete_task)
        self.markCompleteButton.clicked.connect(self.mark_complete)
        self.logoutButton.clicked.connect(self.logout)

    def load_tasks(self):
        if os.path.exists(self.tasks_file):
            with open(self.tasks_file, "r") as f:
                self.tasks = json.load(f)
        else:
            self.tasks = {}

    def save_tasks(self):
        with open(self.tasks_file, "w") as f:
            json.dump(self.tasks, f)

    def add_category(self):
        new_category = self.newCategoryInput.text().strip()
        if new_category and new_category not in self.tasks:
            self.tasks[new_category] = []
            self.categoryComboBox.addItem(new_category)
            self.newCategoryInput.clear()
            self.save_tasks()
        elif new_category in self.tasks:
            QMessageBox.warning(self, "錯誤", "分類已存在")
        else:
            QMessageBox.warning(self, "錯誤", "分類名稱不可為空")

    def add_task(self):
        task = self.taskInput.text().strip()
        current_category = self.categoryComboBox.currentText()
        if task and current_category:
            self.tasks[current_category].append(task)
            self.taskList.addItem(task)
            self.taskInput.clear()
            self.save_tasks()
        else:
            QMessageBox.warning(self, "錯誤", "代辦事項或分類不可為空")
'